(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{174:function(e,t,n){},175:function(e,t,n){},202:function(e,t,n){},203:function(e,t,n){"use strict";n.r(t);var i={};n.r(i),n.d(i,"util",(function(){return u})),n.d(i,"parseErrors",(function(){return d})),n.d(i,"getStatus",(function(){return j})),n.d(i,"getStatusColor",(function(){return f}));var r=n(0),o=n.n(r),s=n(54),a=n.n(s),c=(n(174),n(175),n(90)),l=n(20),u=function(){return null},d=function(e){var t;return JSON.stringify(null===(t=e.response)||void 0===t?void 0:t.data).replaceAll("[","").replaceAll("]","").replaceAll('"',"").replaceAll("{","").replaceAll("}","").replaceAll(",","\n")||e.message},j=function(e){return null===e.start_date&&null===e.end_date?"New":e.start_date.length>0&&null===e.end_date?"In progress":e.start_date.length>0&&e.end_date.length>0?"Finished":void 0},f=function(e){switch(e){default:return"primary";case"In progress":return"warning";case"Finished":return"success"}},b={getToken:function(){var e,t,n;return null===(e=document.cookie.split("; "))||void 0===e||null===(t=e.find((function(e){return e.startsWith("token")})))||void 0===t||null===(n=t.split("="))||void 0===n?void 0:n[1]},setToken:function(e){e&&(document.cookie=e)},removeToken:function(){document.cookie="token=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"}},v=n(64),m=n(1),h=function(e){return Object(m.jsx)(v.a,{type:e.type||"button",variant:e.variant||"outlined",onClick:e.onClick,disabled:e.disabled,children:e.title})},g=n(114),O=n(65),x=function(e){return Object(m.jsx)(g.a,{title:e.title,children:Object(m.jsx)(O.a,{color:"primary",type:e.type||"button",onClick:e.onClick,disabled:e.disabled,children:e.icon})})},p=n(215),S=function(){return Object(m.jsx)(p.a,{})},w=n(216),C=function(e){return Object(m.jsx)(w.a,{align:"left",variant:e.variant,children:e.title})},k=n(22),y=n(261),V=n(112),N=n(35),U=function(e){return Object(m.jsxs)(m.Fragment,{children:[e.useFormLabel&&Object(m.jsx)(y.a,{children:e.name.toUpperCase()}),Object(m.jsx)(N.a,{name:e.name,control:e.control,rules:e.rules,render:function(t){var n,i,r=t.field,o=t.fieldState;return Object(m.jsx)(V.a,Object(k.a)(Object(k.a)({inputRef:r.ref,autoComplete:"off"},r),{},{type:e.type,label:e.name,required:null===(n=e.rules)||void 0===n?void 0:n.required,error:o.invalid,helperText:null===(i=o.error)||void 0===i?void 0:i.message}))}})]})},E=function(e){return Object(m.jsx)(U,Object(k.a)(Object(k.a)({},e),{},{type:"text"}))},q=function(e){return Object(m.jsx)(U,Object(k.a)(Object(k.a)({},e),{},{type:"password"}))},T=n(295),_=n(217),A=n(289),F={Text:E,Secret:q,Radio:function(e){return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(y.a,{children:e.name.toLowerCase()}),Object(m.jsx)(N.a,{name:e.name,control:e.control,rules:e.rules,render:function(t){var n=t.field;t.fieldState;return Object(m.jsx)(T.a,Object(k.a)(Object(k.a)({},n),{},{children:e.options.map((function(e){return Object(m.jsx)(_.a,{value:e.value,control:Object(m.jsx)(A.a,{}),label:e.label})}))}))}})]})}},L=n(8),I=n(292),R=n(290),M=function(e){var t=o.a.useState(!0),n=Object(L.a)(t,2),i=n[0],r=n[1];return Object(m.jsx)(I.a,{open:i,onClose:function(){return r(!1)},autoHideDuration:3e3,anchorOrigin:{vertical:"top",horizontal:"center"},children:Object(m.jsx)(R.a,{severity:e.severity,onClose:function(){return r(!1)},children:e.message})})},W=n(266),D=n(300),Q=n(301),z=n(296),P=function(e){return Object(m.jsxs)(D.a,{className:"grid-cols-1 p-3",children:[Object(m.jsx)("div",{className:"flex justify-center items-center",children:(t=Math.floor(e.active/e.total*100),n=e.icon,i=e.color,Object(m.jsxs)(W.a,{sx:{position:"relative"},children:[Object(m.jsx)(p.a,{variant:"determinate",sx:{color:function(e){return e.palette.grey[200]},position:"absolute",left:0},size:100,thickness:6,value:100}),Object(m.jsx)(p.a,{variant:"determinate",disableShrink:!0,size:100,thickness:8,value:t||0,color:i}),Object(m.jsx)("span",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:n})]}))}),Object(m.jsxs)(Q.a,{children:[Object(m.jsx)(w.a,{gutterBottom:!0,variant:"h5",component:"div",children:e.title}),Object(m.jsxs)("p",{children:["Total: ",Object(m.jsx)(z.a,{label:e.total,color:"default"})]}),Object(m.jsxs)("p",{children:[e.title,": ",Object(m.jsx)(z.a,{label:e.active,color:e.color})]})]})]});var t,n,i},B=n(288),H=n(297),J=n(267),Z=n(268),$=n(269),G=n(270),K=n(135),X=n.n(K),Y=(window.location.href.includes("localhost")?"http://localhost:8000/administration":window.location.origin+"/administration")+"/api",ee=X.a.create({baseURL:Y,withCredentials:!0,headers:{"Content-Type":"application/json",Accept:"application/json"}});ee.interceptors.response.use((function(e){return e}),(function(e){var t,n;return 403!==(null===(t=e.response)||void 0===t?void 0:t.status)&&401!==(null===(n=e.response)||void 0===n?void 0:n.status)||(b.removeToken(),window.location.reload()),Promise.reject(e)})),ee.interceptors.response.use((function(e){return e}),(function(e){return Promise.reject(e)}));var te={getUsers:function(){return ee.get("/users")},deleteUsers:function(e){return ee.delete("/users",{data:{idList:e}})},updateUsersActive:function(e,t){return ee.post("/users/state",{idList:e,state:"Active",value:t?"True":"False"})},updateUsersRole:function(e,t,n){return ee.post("/users/state",{idList:e,state:n,value:t?"True":"False"})},getUser:function(e){return ee.get("/users/".concat(e))},createUser:function(e){return ee.post("/users",e)},updateUser:function(e,t){return ee.put("/users/".concat(e),t)},deleteUser:function(e){return ee.delete("/users/".concat(e))}},ne={login:function(e,t){return ee.post("/auth/login",{username:e,password:t})},logout:function(){return ee.post("/auth/logout")}},ie={getQuestions:function(){return ee.get("/voting/question")},deleteQuestions:function(e){return ee.delete("/voting/questions",{data:{idList:e}})},deleteAllQuestions:function(){return ee.delete("/voting/question")},getQuestion:function(e){return ee.get("/voting/question/".concat(e))},createQuestion:function(e){return ee.post("/voting/question/",e)},updateQuestion:function(e,t){return ee.put("/voting/question/".concat(t),e)},deleteQuestion:function(e){return ee.delete("/voting/question/".concat(e))},getVotings:function(){return ee.get("/votings")},deleteVotings:function(e){return ee.delete("/votings",{data:{idList:e}})},deleteAllVotings:function(){return ee.delete("/votings")},startVotings:function(e){return ee.put("/votings",{idList:e,action:"start"})},stopVotings:function(e){return ee.put("/votings",{idList:e,action:"stop"})},tallyVotings:function(e){return ee.put("/votings",{idList:e,action:"tally"})},getVoting:function(e){return ee.get("/votings/".concat(e))},createVoting:function(e){return ee.post("/votings",e)},updateVoting:function(e,t){return ee.put("/votings/".concat(t),e)},deleteVoting:function(e){return ee.delete("/votings/".concat(e))}},re={getData:function(){return ee.get("/dashboard")}},oe=function(e){return Object(m.jsx)(c.b,{to:e.href||".",children:Object(m.jsx)(g.a,{title:e.label||"",children:Object(m.jsx)(H.a,{icon:e.icon})})})},se=function(e){var t=o.a.useState(0),n=Object(L.a)(t,2),i=n[0],r=n[1],s=Object(l.f)();o.a.useEffect((function(){var e=s.pathname.split("/")[1];""===e||"home"===e?r(0):"users"===e?r(1):"votings"===e&&r(2)}),[s]);return Object(m.jsxs)(W.a,{className:"inline-flex flex-col w-1/12 h-screen justify-between py-12",children:[Object(m.jsxs)("div",{children:[Object(m.jsx)(J.a,{scale:100}),Object(m.jsx)("p",{className:"text-sm font-bold",children:"DECIDE"}),Object(m.jsx)("p",{className:"text-xs",children:"ADMIN"})]}),!e.hidden&&Object(m.jsx)("nav",{children:Object(m.jsxs)(B.a,{value:i,onChange:function(e,t){r(t)},"aria-label":"nav tabs",orientation:"vertical",centered:!0,children:[Object(m.jsx)(oe,{label:"Home",icon:Object(m.jsx)(Z.a,{}),href:"/home"}),Object(m.jsx)(oe,{label:"Users",icon:Object(m.jsx)($.a,{}),href:"/users"}),Object(m.jsx)(oe,{label:"Votings",icon:Object(m.jsx)(J.a,{}),href:"/votings"})]})}),Object(m.jsx)(x,{title:"Logout",onClick:function(){return ne.logout().finally((function(){b.removeToken(),window.location.reload()}))},icon:Object(m.jsx)(G.a,{})})]})},ae=n(136),ce=function(e){var t=r.useCallback((function(t){return e.rows.filter((function(e){return t.includes(e.id)}))}),[e.rows]),n=r.useState(e.initialSelection||[]),i=Object(L.a)(n,2),o=i[0],s=i[1],a=r.useCallback((function(n){s(n),e.setSelected(t(n))}),[e,t]);return r.useEffect((function(){a(o)}),[e.rows]),Object(m.jsx)("div",{className:"w-full",children:Object(m.jsx)(ae.a,{autoHeight:!0,rows:e.rows,columns:e.columns,pageSize:10,checkboxSelection:!0,selectionModel:e.initialSelection||o,onSelectionModelChange:function(e){return a(e)}})})},le=n(302),ue=n(271),de=n(303),je=function(e){var t=o.a.useState(!1),n=Object(L.a)(t,2),i=n[0],r=n[1],s=o.a.useState(1),a=Object(L.a)(s,2),c=a[0],l=a[1],u=function(){r(!1)};return o.a.useEffect((function(){u()}),[e.externalClose]),Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(x,{title:e.title,onClick:function(){r(!0)},icon:e.openerIcon}),i&&Object(m.jsxs)(le.a,{open:i,onClose:u,fullWidth:!0,children:[Object(m.jsx)(ue.a,{children:e.title}),Object(m.jsxs)("form",{autoComplete:"off",className:"space-y-5",onSubmit:function(t){t.preventDefault(),e.onSubmit()},children:[e.pages.map((function(e,t){return Object(m.jsx)("div",{hidden:c!==t+1,children:e},t)})),Object(m.jsxs)(de.a,{className:"gap-11",children:[e.pages.length>1&&Object(m.jsxs)("div",{className:"flex items-end gap-5",children:[Object(m.jsx)(h,{onClick:function(){l(c-1)},title:"Back",disabled:1===c}),c," / ",e.pages.length,Object(m.jsx)(h,{onClick:function(){l(c+1)},title:"Next",disabled:c===e.pages.length})]}),Object(m.jsx)(h,{variant:"contained",title:"Submit",type:"submit"})]})]})]})]})},fe=n(304),be=n(305),ve=function(e){return Object(m.jsxs)(fe.a,{children:[Object(m.jsx)(be.a,{children:e.description}),Object(m.jsx)("br",{}),Object(m.jsx)("div",{className:"flex flex-col items-center gap-2",children:e.children})]})},me=[{field:"is_active",headerName:"Status",minWidth:120,renderCell:function(e){return Object(m.jsx)(z.a,{label:e.value?"active":"not-active",color:e.value?"success":"warning"})}},{field:"username",headerName:"Username",minWidth:140},{field:"first_name",headerName:"First name",minWidth:170},{field:"last_name",headerName:"Last name",minWidth:170},{field:"email",headerName:"Email",minWidth:230},{field:"is_staff",headerName:"Staff",minWidth:80,align:"center",renderCell:function(e){return e.value&&Object(m.jsx)(z.a,{label:"\u2714",color:"primary"})}},{field:"is_superuser",headerName:"Superuser",minWidth:120,align:"center",renderCell:function(e){return e.value&&Object(m.jsx)(z.a,{label:"\u26e8",color:"primary"})}}],he=function(e){return Object(m.jsx)(ce,{rows:e.users,columns:me,setSelected:e.setSelected,initialSelection:e.initialSelection})},ge=n(272),Oe=n(273),xe=function(e){var t,n=o.a.useMemo((function(){var t;return!!(null===(t=e.initialUser)||void 0===t?void 0:t.id)}),[e.initialUser]),r=Object(N.b)({mode:"onChange"}),s=r.control,a=r.getValues,c=r.trigger,l=r.clearErrors,u=r.formState.errors,d=r.reset,j=o.a.useState(!1),f=Object(L.a)(j,2),b=f[0],v=f[1];o.a.useEffect((function(){var t,n,i,r;d({}),l(),c(),s._defaultValues={username:null===(t=e.initialUser)||void 0===t?void 0:t.username,password:"",first_name:null===(n=e.initialUser)||void 0===n?void 0:n.first_name,last_name:null===(i=e.initialUser)||void 0===i?void 0:i.last_name,email:null===(r=e.initialUser)||void 0===r?void 0:r.email}}),[e.initialUser,s,d,l,c]);var h=function(t){var n;l(),null===(n=e.notify)||void 0===n||n.call(e,"error","Submit failed: \n"+t)},g=function(){var t;v(!b),e.refetch(),null===(t=e.notify)||void 0===t||t.call(e,"success",n?"User updated":"User created"),d({})};return Object(m.jsx)(je,{onSubmit:function(){return function(t){var r;if(0===Object.keys(u).length)if(n&&(null===(r=e.initialUser)||void 0===r?void 0:r.id)){var o;te.updateUser(null===(o=e.initialUser)||void 0===o?void 0:o.id,t).then((function(){return g()})).catch((function(e){return h(i.parseErrors(e))}))}else te.createUser(t).then((function(){return g()})).catch((function(e){return h(i.parseErrors(e))}))}(a())},title:n?"Edit "+(null===(t=e.initialUser)||void 0===t?void 0:t.first_name):"New User",openerIcon:n?Object(m.jsx)(ge.a,{}):Object(m.jsx)(Oe.a,{}),externalClose:b,pages:[Object(m.jsxs)(ve,{description:"Indique la informaci\xf3n del Usuario",children:[Object(m.jsx)(F.Text,{control:s,name:"username",rules:{required:"This field is required",pattern:{value:/^[a-z0-9]+$/,message:"Use lowercase letters and numbers"}}}),Object(m.jsx)(F.Secret,{control:s,name:"password",rules:n?{}:{required:"This field is required"}}),Object(m.jsx)(F.Text,{control:s,name:"first_name"}),Object(m.jsx)(F.Text,{control:s,name:"last_name"}),Object(m.jsx)(F.Text,{control:s,name:"email",rules:{pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}}})]})]})},pe=n(15),Se=n(274),we=function(e){var t=o.a.useState({desc:"",options:[{number:1,option:""},{number:2,option:""}]}),n=Object(L.a)(t,2),i=n[0],r=n[1];return Object(m.jsx)(m.Fragment,{children:Object(m.jsx)(N.a,{name:"question",control:e.control,rules:{validate:{descRequired:function(e){return!!e.desc&&""!==e.desc},optionsRequired:function(e){return!!e.options&&e.options.length>1}}},render:function(e){var t,n,o,s=e.field,a=e.fieldState;return function(e){e.value?r(e.value):e.onChange(i)}(s),Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(y.a,{children:"Question".toLowerCase()}),Object(m.jsx)(V.a,{autoComplete:"off",onChange:function(e){return s.onChange(function(e){var t=Object(k.a)(Object(k.a)({},i),{},{desc:e.target.value});return r(t),t}(e))},type:"text",label:"question",required:!0,error:a.invalid,helperText:null===(t=a.error)||void 0===t?void 0:t.message,value:(null===(n=s.value)||void 0===n?void 0:n.desc)||""}),Object(m.jsx)(y.a,{className:"mt-10",children:"Options".toLowerCase()}),null===(o=s.value)||void 0===o?void 0:o.options.map((function(e,t){var n,o,c,l;return Object(m.jsxs)("div",{className:"flex flex-row items-center",children:[Object(m.jsx)(V.a,{autoComplete:"off",onChange:function(t){return s.onChange(function(e,t){var n=Object(k.a)(Object(k.a)({},i),{},{options:i.options.map((function(n,i){return n.number===e?Object(k.a)(Object(k.a)({},n),{},{option:t}):n}))});return r(n),n}(e.number,t.target.value))},value:(null===(n=s.value)||void 0===n||null===(o=n.options)||void 0===o||null===(c=o[t])||void 0===c?void 0:c.option)||"",type:"text",label:"option ".concat(e.number),required:!0,error:a.invalid,helperText:null===(l=a.error)||void 0===l?void 0:l.message},t),t>1&&Object(m.jsx)(x,{onClick:function(){return s.onChange(function(e){var t=Object(k.a)(Object(k.a)({},i),{},{options:i.options.filter((function(t){return t.number!==e}))});return r(t),t}(e.number))},icon:Object(m.jsx)(Se.a,{}),title:"Remove Option"})]})})),Object(m.jsx)("hr",{}),Object(m.jsx)(x,{onClick:function(){return s.onChange(function(){var e=Object(k.a)(Object(k.a)({},i),{},{options:[].concat(Object(pe.a)(i.options),[{number:i.options.length+1,option:""}])});return r(e),e}())},icon:Object(m.jsx)(Oe.a,{}),title:"Add Option"})]})}})})},Ce=n(275),ke=function(e){var t=o.a.useState(!1),n=Object(L.a)(t,2),i=n[0],r=n[1],s=o.a.useState([]),a=Object(L.a)(s,2),c=a[0],l=a[1],u=function(){r(!i)};return o.a.useEffect((function(){te.getUsers().then((function(e){l(e.data)})).catch((function(e){l([])}))}),[i]),Object(m.jsx)(N.a,{name:"census",control:e.control,rules:{required:!0},render:function(e){var t=e.field;e.fieldState;return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(y.a,{children:"Census".toLowerCase()}),Object(m.jsx)(he,{setSelected:function(e){return t.onChange(e.map((function(e){return e.id})))},initialSelection:t.value||[],users:c}),Object(m.jsx)(x,{onClick:u,icon:Object(m.jsx)(Ce.a,{}),title:"Refetch"})]})}})},ye=n(276),Ve=n(277),Ne=[{field:"status",headerName:"Status",minWidth:140,renderCell:function(e){var t=i.getStatus(e.row),n=i.getStatusColor(t||"");return Object(m.jsx)(z.a,{label:t,color:n})}},{field:"name",headerName:"Name",minWidth:140},{field:"question",headerName:"Question",minWidth:250,renderCell:function(e){return Object(m.jsx)(g.a,{title:e.row.question.options.map((function(e){return"".concat(e.number,": ").concat(e.option)})).join("; "),arrow:!0,children:Object(m.jsx)("span",{children:e.row.question.desc})})}},{field:"start_date",headerName:"Start",minWidth:140,valueFormatter:function(e){var t,n;return(null===(t=e.value)||void 0===t||null===(n=t.toLocaleString())||void 0===n?void 0:n.split("T")[0])||""}},{field:"end_date",headerName:"End",minWidth:140,valueFormatter:function(e){var t,n;return(null===(t=e.value)||void 0===t||null===(n=t.toLocaleString())||void 0===n?void 0:n.split("T")[0])||""}},{field:"census",headerName:"Census",minWidth:100,align:"center",valueFormatter:function(e){var t;return null===(t=e.value)||void 0===t?void 0:t.length}},{field:"tally",headerName:"Votes",minWidth:100,align:"center",valueFormatter:function(e){return"[]"===e.value?"0":e.value.replace("[","").replace("]","")}},{field:"link",headerName:"Links",align:"center",renderCell:function(e){var t=i.getStatus(e.row);return Object(m.jsxs)(m.Fragment,{children:["In progress"===t&&Object(m.jsx)(x,{title:"Vote!",icon:Object(m.jsx)(ye.a,{}),onClick:function(){return window.open("http://"+window.location.hostname+(window.location.port?":"+window.location.port:"")+"/booth/"+e.row.id)}}),"Finished"===t&&Object(m.jsx)(x,{title:"Results",icon:Object(m.jsx)(Ve.a,{}),onClick:function(){return window.open("http://"+window.location.hostname+(window.location.port?":"+window.location.port:"")+"/visualizer/"+e.row.id)}})]})}}],Ue=function(e){return Object(m.jsx)(ce,{rows:e.votings,columns:Ne,setSelected:e.setSelected})},Ee=function(e){var t,n,r,s=o.a.useMemo((function(){var t;return!!(null===(t=e.initialVoting)||void 0===t?void 0:t.id)}),[e.initialVoting]),a=Object(N.b)({mode:"onChange"}),c=a.control,l=a.getValues,u=a.trigger,d=a.clearErrors,j=a.formState.errors,f=a.reset,b=o.a.useState(!1),v=Object(L.a)(b,2),h=v[0],g=v[1];o.a.useEffect((function(){var t,n,i,r,o;(f({}),d(),u(),e.initialVoting)&&(c._defaultValues={name:null===(t=e.initialVoting)||void 0===t?void 0:t.name,desc:null===(n=e.initialVoting)||void 0===n?void 0:n.desc,census:null===(i=e.initialVoting)||void 0===i?void 0:i.census,question:null===(r=e.initialVoting)||void 0===r?void 0:r.question,auth:null===(o=e.initialVoting)||void 0===o?void 0:o.auth})}),[e.initialVoting,c,f,d,u]);var O=function(t){var n;d(),null===(n=e.notify)||void 0===n||n.call(e,"error","Submit failed: \n"+t)},x=function(){var t;g(!h),e.refetch(),null===(t=e.notify)||void 0===t||t.call(e,"success",s?"Voting updated":"Voting created"),f({})};return Object(m.jsx)(je,{onSubmit:function(){return function(t){var n;if(0===Object.keys(j).length)if(s&&(null===(n=e.initialVoting)||void 0===n?void 0:n.id)){var r;ie.updateVoting(t,null===(r=e.initialVoting)||void 0===r?void 0:r.id).then((function(){return x()})).catch((function(e){return O(i.parseErrors(e))}))}else ie.createVoting(t).then((function(){return x()})).catch((function(e){return O(i.parseErrors(e))}))}(l())},title:s?"Edit Voting "+(null===(t=e.initialVoting)||void 0===t?void 0:t.name):"New Voting",openerIcon:s?Object(m.jsx)(ge.a,{}):Object(m.jsx)(Oe.a,{}),externalClose:h,pages:[Object(m.jsxs)(ve,{description:"Indique la informaci\xf3n de la Votaci\xf3n",children:[Object(m.jsx)(F.Text,{control:c,name:"name",error:null===(n=j.name)||void 0===n?void 0:n.message,rules:{required:!0}}),Object(m.jsx)(F.Text,{control:c,name:"desc",error:null===(r=j.desc)||void 0===r?void 0:r.message})]}),Object(m.jsx)(ve,{description:"Indique la pregunta de la Votaci\xf3n",children:Object(m.jsx)(we,{control:c})}),Object(m.jsx)(ve,{description:"Indique el censo de la Votaci\xf3n",children:Object(m.jsx)(ke,{control:c})}),Object(m.jsx)(ve,{description:"Indique la autorizaci\xf3n requerida para la Votaci\xf3n",children:Object(m.jsx)(F.Radio,{control:c,name:"auth",rules:{required:!0},options:[{label:"Local (localhost:8000)",value:"http://localhost:8000"},{label:"Default (".concat(window.location.host,")"),value:"http://".concat(window.location.host)}]})})]})},qe=n(278),Te=n(279),_e=function(e){var t,n,i=o.a.useMemo((function(){return e.selection&&e.selection.length>=1}),[e.selection]);return Object(m.jsx)(qe.a,{id:"actions",className:"inline-flex items-center w-1/12 h-screen px-2",children:Object(m.jsxs)(qe.a,{className:"w-12 flex flex-col border rounded p-2 gap-3",children:[e.actions,Object(m.jsx)(Te.a,{}),null===(t=e.individualActions)||void 0===t?void 0:t.map((function(e,t){return Object(m.jsx)(x,{title:e.title,icon:e.icon,onClick:e.onClick},t)})),Object(m.jsx)(Te.a,{}),null===(n=e.bulkActions)||void 0===n?void 0:n.map((function(e,t){return Object(m.jsx)(x,{title:e.title,icon:e.icon,onClick:e.onClick,disabled:e.disabled||!i},t)}))]})})},Ae=function(e){var t;return Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)(W.a,{className:"inline-block w-10/12 h-screen p-1 md:p-5 xl:p-10",children:[Object(m.jsxs)(W.a,{id:"content",className:"my-2 ml-10 inline-block w-11/12",children:[Object(m.jsx)(C,{title:e.title,variant:"h3"}),Object(m.jsx)("hr",{className:"my-6"}),e.children]}),Object(m.jsx)("div",{id:"Notifications",children:null===(t=e.notifications)||void 0===t?void 0:t.map((function(e){return Object(m.jsx)(M,{severity:e.type,message:e.message})}))})]})})},Fe=function(){var e=o.a.useState(),t=Object(L.a)(e,2),n=t[0],i=t[1],r=o.a.useState(!1),s=Object(L.a)(r,2),a=s[0],c=s[1],l=o.a.useState([]),u=Object(L.a)(l,2),d=u[0],j=u[1];o.a.useEffect((function(){re.getData().then((function(e){i(e.data)})).catch((function(e){return t="error",n="Stats not fetched: "+e.message,void j((function(e){return[].concat(Object(pe.a)(e),[{type:t,message:n}])}));var t,n}))}),[a]);var f=o.a.useMemo((function(){return(null===n||void 0===n?void 0:n.votings)?Object.values(n.votings).reduce((function(e,t){return e+t}),0):0}),[n]);return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(Ae,{title:"Home",notifications:d,children:Object(m.jsxs)("div",{className:"grid grid-cols-3 gap-7",children:[Object(m.jsx)(P,{title:"Active users",active:(null===n||void 0===n?void 0:n.users.active)||0,total:(null===n||void 0===n?void 0:n.users.total)||0,icon:Object(m.jsx)($.a,{}),color:"success"}),Object(m.jsx)(P,{title:"Employees",active:(null===n||void 0===n?void 0:n.users.employees)||0,total:(null===n||void 0===n?void 0:n.users.total)||0,icon:Object(m.jsx)($.a,{}),color:"primary"}),Object(m.jsx)(P,{title:"Admins",active:(null===n||void 0===n?void 0:n.users.admins)||0,total:(null===n||void 0===n?void 0:n.users.total)||0,icon:Object(m.jsx)($.a,{}),color:"primary"}),Object(m.jsx)(P,{title:"Votings not started",active:(null===n||void 0===n?void 0:n.votings.notStarted)||0,total:f,icon:Object(m.jsx)(J.a,{}),color:"primary"}),Object(m.jsx)(P,{title:"Votings in progress",active:(null===n||void 0===n?void 0:n.votings.inProgress)||0,total:f,icon:Object(m.jsx)(J.a,{}),color:"warning"}),Object(m.jsx)(P,{title:"Votings finished",active:(null===n||void 0===n?void 0:n.votings.finished)||0,total:f,icon:Object(m.jsx)(J.a,{}),color:"success"})]})}),Object(m.jsx)(_e,{individualActions:[{icon:Object(m.jsx)(Ce.a,{}),title:"Refresh",onClick:function(){return c(!a)}}]})]})},Le=function(){return Object(m.jsx)(Ae,{title:"404",children:"not found"})},Ie=function(){var e,t,n=Object(N.b)(),r=n.control,s=n.getValues,a=n.setError,c=n.formState.errors,l=o.a.useState([]),u=Object(L.a)(l,2),d=u[0],j=u[1],f=function(e,t){j((function(n){return[].concat(Object(pe.a)(n),[{type:e,message:t}])}))},v=function(e){ne.login(e.username,e.password).then((function(e){var t;b.setToken(null===e||void 0===e||null===(t=e.headers["set-cookie"])||void 0===t?void 0:t[0]),window.location.reload()})).catch((function(e){!function(e){var t,n,r;e.response||(a("password",{type:"manual",message:"Server Error"}),a("username",{type:"manual",message:""}),f("error","Server Error")),400===(null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.status)&&(a("password",{type:"manual",message:(null===(n=e.response.data)||void 0===n?void 0:n.password)||""}),a("username",{type:"manual",message:(null===(r=e.response.data)||void 0===r?void 0:r.username)||""}),f("error","ERRORS: "+i.parseErrors(e)||!1))}(e)}))};return Object(m.jsx)(Ae,{title:"Log In",notifications:d,children:Object(m.jsx)(W.a,{className:"flex flex-col w-60 mx-auto my-4",children:Object(m.jsxs)("form",{className:"space-y-5",onSubmit:function(e){e.preventDefault(),v(s())},children:[Object(m.jsx)(F.Text,{name:"username",control:r,error:null===(e=c.username)||void 0===e?void 0:e.message}),Object(m.jsx)(F.Secret,{name:"password",control:r,error:null===(t=c.password)||void 0===t?void 0:t.message}),Object(m.jsx)(h,{title:"LogIn",type:"submit"})]})})})},Re=n(280),Me=n(281),We=n(282),De=n(283),Qe=n(284),ze=function(){var e=o.a.useState([]),t=Object(L.a)(e,2),n=t[0],i=t[1],r=o.a.useState([]),s=Object(L.a)(r,2),a=s[0],c=s[1],l=o.a.useState(!1),u=Object(L.a)(l,2),d=u[0],j=u[1],f=o.a.useState([]),b=Object(L.a)(f,2),v=b[0],h=b[1],g=function(e,t){h((function(n){return[].concat(Object(pe.a)(n),[{type:e,message:t}])}))},O=function(){j(!d)};o.a.useEffect((function(){te.getUsers().then((function(e){i(e.data)})).catch((function(e){return g("error","Users not fetched: "+e.message)}))}),[d]);var x=o.a.useMemo((function(){return a.map((function(e){return e.id||-1}))}),[a]),p=o.a.useMemo((function(){var e=function(e){return e===a.length&&a.length>0?"true":0===e?"false":"mixed"},t=a.filter((function(e){return e.is_active})).length,n=a.filter((function(e){return e.is_staff})).length,i=a.filter((function(e){return e.is_superuser})).length;return{active:e(t),staff:e(n),su:e(i)}}),[a]),S=function(e){g("info","Loading..."),te.updateUsersActive(x,e).then((function(e){O(),g("success","User/s status changed")})).catch((function(e){return g("error","Error updating status: "+e.message)}))},w=function(e,t){g("info","Loading..."),te.updateUsersRole(x,e,t).then((function(e){O(),g("success","User/s roles changed")})).catch((function(e){return g("error","Error updating roles: "+e.message)}))};return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(Ae,{title:"Users",notifications:v,children:Object(m.jsx)(he,{users:n,setSelected:c})}),Object(m.jsx)(_e,{selection:a,actions:[Object(m.jsx)(xe,{initialUser:1===a.length?a[0]:void 0,refetch:O,notify:g})],individualActions:[{icon:Object(m.jsx)(Ce.a,{}),title:"Refresh",onClick:function(){return O()}}],bulkActions:[{icon:Object(m.jsx)(Re.a,{}),title:"Delete",onClick:function(){te.deleteUsers(x).then((function(e){O(),g("success","User/s deleted")})).catch((function(e){return g("error","Error deleting user/s: "+e.message)}))}},{icon:"true"===p.active?Object(m.jsx)(Me.a,{color:"warning"}):Object(m.jsx)(We.a,{}),title:"true"===p.active?"Mark as Inactive":"Mark as Active",disabled:"mixed"===p.active,onClick:function(){"true"===p.active?S(!1):S(!0)}},{icon:"true"===p.staff?Object(m.jsx)(De.a,{color:"warning"}):Object(m.jsx)(De.a,{}),title:"true"===p.staff?"Remove Staff":"Make Staff",disabled:"mixed"===p.staff,onClick:function(){"true"===p.staff?w(!1,"Staff"):w(!0,"Staff")}},{icon:"true"===p.su?Object(m.jsx)(Qe.a,{color:"warning"}):Object(m.jsx)(Qe.a,{}),title:"true"===p.su?"Remove SuperUser":"Make SuperUser",disabled:"mixed"===p.su,onClick:function(){"true"===p.su?w(!1,"Superuser"):w(!0,"Superuser")}}]})]})},Pe=n(285),Be=n(286),He=function(){var e=o.a.useState([]),t=Object(L.a)(e,2),n=t[0],r=t[1],s=o.a.useState([]),a=Object(L.a)(s,2),c=a[0],l=a[1],u=o.a.useState(!1),d=Object(L.a)(u,2),j=d[0],f=d[1],b=o.a.useState([]),v=Object(L.a)(b,2),h=v[0],g=v[1],O=function(e,t){g((function(n){return[].concat(Object(pe.a)(n),[{type:e,message:t}])}))},x=function(){f(!j)};o.a.useEffect((function(){ie.getVotings().then((function(e){r(e.data)})).catch((function(e){return O("error","Votings not fetched: "+e.message)}))}),[j]);var p=o.a.useMemo((function(){return c.map((function(e){return e.id||-1}))}),[c]),S=o.a.useMemo((function(){return{status:function(e,t,n){return e===c.length&&c.length>0?"new":t===c.length&&c.length>0?"in_progress":n===c.length&&c.length>0?"finished":"mixed"}(c.filter((function(e){return"New"===i.getStatus(e)})).length,c.filter((function(e){return"In progress"===i.getStatus(e)})).length,c.filter((function(e){return"Finished"===i.getStatus(e)})).length)}}),[c]);return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(Ae,{title:"Votings",notifications:h,children:Object(m.jsx)(Ue,{votings:n,setSelected:l})}),Object(m.jsx)(_e,{selection:c,actions:[Object(m.jsx)(Ee,{initialVoting:1===c.length?c[0]:void 0,refetch:x,notify:O})],individualActions:[{icon:Object(m.jsx)(Ce.a,{}),title:"Refresh",onClick:function(){return x()}}],bulkActions:[{icon:Object(m.jsx)(Re.a,{}),title:"Delete",onClick:function(){ie.deleteVotings(p).then((function(e){x(),O("success","Voting/s deleted")}))}},{icon:"new"===S.status?Object(m.jsx)(We.a,{}):"in_progress"===S.status?Object(m.jsx)(Pe.a,{}):"finished"===S.status?Object(m.jsx)(ye.a,{}):Object(m.jsx)(Be.a,{}),title:"new"===S.status?"Start":"in_progress"===S.status?"Stop":"finished"===S.status?"Tally":"Cancel",disabled:"mixed"===S.status,onClick:function(){var e;e=S.status,O("info","Loading..."),"new"===e&&ie.startVotings(p).then((function(e){x(),O("success","Voting/s started")})).catch((function(e){return O("error","Voting/s not started: "+e.message)})),"in_progress"===e&&ie.stopVotings(p).then((function(e){x(),O("success","Voting/s stopped")})).catch((function(e){return O("error","Voting/s not stopped: "+e.message)})),"finished"===e&&ie.tallyVotings(p).then((function(e){x(),O("success","Voting/s tallied")})).catch((function(e){return O("error","Voting/s not tallied: "+e.message)}))}}]})]})},Je=function(){var e=null===b||void 0===b?void 0:b.getToken();return o.a.useEffect((function(){return console.log("rendered, auth: ".concat(e),b.getToken())}),[e]),Object(m.jsx)(r.Suspense,{fallback:Object(m.jsx)("div",{className:"h-full w-full flex items-center justify-center",children:Object(m.jsx)(S,{})}),children:Object(m.jsxs)(c.a,{basename:"/administration",children:[Object(m.jsx)(se,{hidden:!e}),Object(m.jsx)(l.d,{children:e?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(l.b,{path:"/users",element:Object(m.jsx)(ze,{})}),Object(m.jsx)(l.b,{path:"/votings",element:Object(m.jsx)(He,{})}),Object(m.jsx)(l.b,{path:"/home",element:Object(m.jsx)(Fe,{})}),Object(m.jsx)(l.b,{path:"/404",element:Object(m.jsx)(Le,{})}),Object(m.jsx)(l.b,{path:"*",element:Object(m.jsx)(l.a,{to:"/404"})})]}):Object(m.jsx)(l.b,{path:"*",element:Object(m.jsx)(Ie,{})})})]})})},Ze=(n(202),function(){return Object(m.jsx)("div",{className:"App flex",children:Object(m.jsx)(Je,{})})}),$e=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,306)).then((function(t){var n=t.getCLS,i=t.getFID,r=t.getFCP,o=t.getLCP,s=t.getTTFB;n(e),i(e),r(e),o(e),s(e)}))};a.a.render(Object(m.jsx)(o.a.StrictMode,{children:Object(m.jsx)(Ze,{})}),document.getElementById("root")),$e()}},[[203,1,2]]]);
//# sourceMappingURL=main.0b89869b.chunk.js.map